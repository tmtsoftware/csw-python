<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>esw API documentation</title>
<meta name="description" content="Introduction â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>esw</code></h1>
</header>
<section id="section-intro">
<h2 id="introduction">Introduction</h2>
<p>This submodule contains python APIs for the <a href="https://tmtsoftware.github.io/esw/">TMT Executive Software (ESW)</a>,
including a Sequencer client and ESW Shell.
See <a href="https://tmtsoftware.github.io/esw/">here</a> for the ESW documentation.</p>
<p>You can find the <a href="https://github.com/tmtsoftware/csw-python">csw-python sources</a> on GitHub.</p>
<p>Note that all APIs here assume that the latest version of CSW services are running
For example, during development, run: <code>csw-services start</code>.</p>
<p>The Python APIs mirror the ESW Scala and Java APIs. The classes usually have the same fields,
with the difference that in some cases the Python types are simpler, due to less strict typing.</p>
<h2 id="esw-shell">ESW Shell</h2>
<p>The esw-shell command provides an interactive shell with predefined imports
where you can type in CSW and ESW commands. The following example publishes an event:</p>
<pre><code class="language-bash">&gt; esw-shell.sh
Wellcome to ESW Shell
&gt;&gt;&gt; source = Prefix(Subsystems.CSW, &quot;testassembly&quot;)
&gt;&gt;&gt; eventName = EventName(&quot;myAssemblyEvent&quot;)
&gt;&gt;&gt; param = DoubleKey.make(&quot;assemblyEventValue&quot;).set(42.0)
&gt;&gt;&gt; paramSet = [param]
&gt;&gt;&gt; event = SystemEvent(source, eventName, paramSet)
&gt;&gt;&gt; pub = EventPublisher()
&gt;&gt;&gt; pub.publish(event)
&gt;&gt;&gt; 
</code></pre>
<p>This is just an interactive Python session with the commonly used imports provided.
You can add your own imports, etc. The following example submits commands to an assembly:</p>
<pre><code class="language-bash">&gt; esw-shell.sh
Wellcome to ESW Shell
&gt;&gt;&gt; prefix = Prefix(Subsystems.CSW, &quot;TestClient&quot;)
&gt;&gt;&gt; maybeObsId = []
&gt;&gt;&gt; param = IntKey.make(&quot;testValue&quot;).set(42)
&gt;&gt;&gt; paramSet = [param]
&gt;&gt;&gt; cs = CommandService(Prefix(Subsystems.CSW, &quot;TestPublisher&quot;), ComponentType.Assembly)
&gt;&gt;&gt; setup = Setup(prefix, CommandName(&quot;longRunningCommand&quot;), maybeObsId, paramSet)
&gt;&gt;&gt; resp = cs.submitAndWait(setup, 5)
&gt;&gt;&gt; resp
Completed(runId='6c476544-4e84-4f8f-b10a-8172576ef68d', result=Result(paramSet=[]))
</code></pre>
<p>The <code>submitAndWait()</code> method submits a command and waits, if needed for the final response.
You can use plain <code>submit()</code> if the command returns a direct response.
There are also asynchronous versions of some methods: <code>queryFinalAsync()</code> and <code>submitAndWaitAsync()</code>,
that can be used in scripts using the <code>async</code> and <code>await</code> keywords.</p>
<pre><code class="language-python">async def foo:
    resp1 = await cs.queryFinalAsync(runId, 5)
    resp2 = await cs.submitAndWaitAsync(setup, 5)
</code></pre>
<h2 id="esw-sequencer-client">ESW Sequencer Client</h2>
<p>Assuming a sequencer is running, you can control it from Python using the ESW Sequencer Client (see <a href="SequencerClient.html">SequencerClient</a>):</p>
<pre><code class="language-python">from csw.Parameter import IntKey
from csw.ParameterSetType import Setup, CommandName
from csw.Prefix import Prefix
from csw.Subsystem import Subsystems
from esw.Sequence import Sequence
from esw.SequencerClient import SequencerClient
from esw.SequencerRes import Ok

sequencerPrefix = Prefix(Subsystems.ESW, &quot;IRIS_ImagerOnly&quot;)
seqClient = SequencerClient(sequencerPrefix)
clientPrefix = Prefix(Subsystems.CSW, &quot;TestClient&quot;)
maybeObsId = []
param = IntKey.make(&quot;testValue&quot;).set(42)
paramSet = [param]

def _makeSetup(name: str):
    return Setup(clientPrefix, CommandName(name), maybeObsId, paramSet)

setup1 = _makeSetup(&quot;Test1&quot;)
setup2 = _makeSetup(&quot;Test2&quot;)
setup3 = _makeSetup(&quot;Test3&quot;)
sequence = Sequence([setup1, setup2, setup3])
resp = seqClient.loadSequence(sequence)
assert (isinstance(resp, Ok))
</code></pre>
<p>See tests/esw/test_sequencer_client.py for some examples.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
.. include:: documentation.md
&#34;&#34;&#34;</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="esw.Sequence" href="Sequence.html">esw.Sequence</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="esw.SequencerClient" href="SequencerClient.html">esw.SequencerClient</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="esw.SequencerRequest" href="SequencerRequest.html">esw.SequencerRequest</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="esw.SequencerRes" href="SequencerRes.html">esw.SequencerRes</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="esw.SequencerServer" href="SequencerServer.html">esw.SequencerServer</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="esw.Step" href="Step.html">esw.Step</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="esw.StepList" href="StepList.html">esw.StepList</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="esw.StepStatus" href="StepStatus.html">esw.StepStatus</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="esw.WsCommands" href="WsCommands.html">esw.WsCommands</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="esw.esw-shell" href="esw-shell.html">esw.esw-shell</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#esw-shell">ESW Shell</a></li>
<li><a href="#esw-sequencer-client">ESW Sequencer Client</a></li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="esw.Sequence" href="Sequence.html">esw.Sequence</a></code></li>
<li><code><a title="esw.SequencerClient" href="SequencerClient.html">esw.SequencerClient</a></code></li>
<li><code><a title="esw.SequencerRequest" href="SequencerRequest.html">esw.SequencerRequest</a></code></li>
<li><code><a title="esw.SequencerRes" href="SequencerRes.html">esw.SequencerRes</a></code></li>
<li><code><a title="esw.SequencerServer" href="SequencerServer.html">esw.SequencerServer</a></code></li>
<li><code><a title="esw.Step" href="Step.html">esw.Step</a></code></li>
<li><code><a title="esw.StepList" href="StepList.html">esw.StepList</a></code></li>
<li><code><a title="esw.StepStatus" href="StepStatus.html">esw.StepStatus</a></code></li>
<li><code><a title="esw.WsCommands" href="WsCommands.html">esw.WsCommands</a></code></li>
<li><code><a title="esw.esw-shell" href="esw-shell.html">esw.esw-shell</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>